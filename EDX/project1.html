<!DOCTYPE html>   
  <html manifest="manifest.appcache" data-revision="1.0" lang="en">
    <head>
      <meta charset="utf-8">  
      <title>HTML5 | EDX Project One</title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <link rel="stylesheet" href="project1-flex.css">
      <link rel="stylesheet" href="project1-normalize.css">
      <link rel="stylesheet" href="project1-style.css">
    </head>
    
    <body ononline="update(true)"
       onoffline="update(false)"
       onload="update(navigator.onLine)">
      <!-- source of above: http://www.w3.org/TR/html5/sections.html -->
      <p style="margin-left:15px;">You are: <span id="status">(Unknown)</span></p>
      
    <main>
        <header>
          <H1>Under Construction: Autopopulate Form with LatLong</H1>
        </header>
        
      <nav>
        <h4>Navigation Menu</h4>
        <ul>
          
          <li><a href="http://red-hound.github.io">Red-Hound</a></li>
          <li><a href="http://red-hound.github.io/EDX/index.html">Worksheet</a></li>
          <li><a href="http://red-hound.github.io/EDX/project1.html">Project One Page</a></li>
          
        </ul>
      </nav>
        <div style="background:url('https://cloud.githubusercontent.com/assets/10208580/8580190/25e62e8c-2587-11e5-8262-cf8933518761.jpg') no-repeat center center;height:500px;background-size:cover;"></div>
        <h6 style="margin-left:15px;">Background image by  Ryan McGuire <a href="http://gratisography.com/">Gratisography</a></h6>
    
        <article>
          <h2>EDX Project AutoPopulate With Lat Long</h2>
          <section>
            <header><h3>Google Maps JavaScript API</h3></header>
          <h4><a href="https://developers.google.com/maps/documentation/javascript/geocoding">GeoCoding</a></h4>
          <h5>Idea for this form is based on the recommendation of a student with disabilities.  He thinks that an ability to text out location in event of emergencies would enable rescue groups to find him.</h5>
          </section>
          <section>
            <h3>Code Based on EDX Course Material</h3>
            <!--MB code for reverse geolocation-->
    <script>
       var displayCoords, myAddress; 
  
       function getLocation() {
          if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(showPosition);
          } else {
          displayCoords.innerHTML="Geolocation API not supported by your browser.";
       }
     }
  
  
      // Called when position is available
    function showPosition(position) {
        displayCoords.innerHTML="Latitude: " + position.coords.latitude + 
            "<br />Longitude: " + position.coords.longitude;    
        showOnGoogleMap(new google.maps.LatLng(position.coords.latitude, position.coords.longitude));
 
    }
 
      var geocoder;
      var map;
      var infowindow = new google.maps.InfoWindow();
      var marker;
      
      function initialize() {
        displayCoords=document.getElementById("msg");
        myAddress = document.getElementById("address");
        
        geocoder = new google.maps.Geocoder();
        var latlng = new google.maps.LatLng(34.0144, -6.83);
        var mapOptions = {
          zoom: 8,
          center: latlng,
          mapTypeId: 'roadmap'
        }
        map = new google.maps.Map(document.getElementById('map_canvas'), mapOptions); 
      }
 
    function showOnGoogleMap(latlng) {
 
        geocoder.geocode({'latLng': latlng}, function(results, status) {
          if (status == google.maps.GeocoderStatus.OK) {
            if (results[1]) {
              map.setZoom(11);
              marker = new google.maps.Marker({
                  position: latlng,
                  map: map
              });
              infowindow.setContent(results[1].formatted_address);
              infowindow.open(map, marker);
              
              // Display address as text in the page
              myAddress.innerHTML="Adress: " + results[0].formatted_address;
              
              // Call the function that parses the results and fills
              // the input fields
              parseResult(results[0].address_components);
            } else {
              alert('No results found');
            }
          } else {
            alert('Geocoder failed due to: ' + status); 
          }
        });
    }     
      
      var country, postalCode, state, route, streetNumber, locality, areaLvl1, areaLvl2;
      
      function parseResult(result) {
        for(i in result){
          // Let's print all the data we can collect from the reverse geocoder,
          // Look at the debug console to see what we get...
          console.log("type = " + result[i].types[0] + " long_name = " + 
                       result[i].long_name);

          if(result[i].types[0] == 'postal_code')
            postalCode = result[i].long_name;
          if(result[i].types[0] == 'country')
            country= result[i].long_name;
          if(result[i].types[0] == 'street_number')
           
            streetNumber= result[i].long_name;
          if(result[i].types[0] == 'route')
            route= result[i].long_name;
           if(result[i].types[0] == 'locality')
            locality= result[i].long_name;
          if(result[i].types[0] == 'state')
            state= result[i].long_name;
          if(result[i].types[0] == 'administrative_area_level_2')
            arealLvl2= result[i].long_name;
          if(result[i].types[0] == 'administrative_area_level_1')
            areaLvl1= result[i].long_name;
        }
          </section>
        </article>
    </main>
    
    <footer  id="references">
    <h4>References for Appcache</h4>
    <ul>
      <li><a href="http://diveintohtml5.info/offline.html">Cache Manifest</a></li>
      <li><a href="http://westciv.com/tools/manifestR/">Make a Manifest Tool</a></li>
      <li><a href="http://appcache.offline.technology/">Appcache Online</a></li>
      
    </ul>
    </footer>
<script src="scripts/monitor.js"></script>
<script src="scripts/status.js"></script>
<script src="scripts/edx-coords1.js"></script>
 </body>
 </html>
        
